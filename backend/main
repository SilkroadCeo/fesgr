from fastapi import FastAPI, HTTPException, UploadFile, File, Form, Request
from fastapi.staticfiles import StaticFiles
from fastapi.responses import FileResponse
from fastapi.middleware.cors import CORSMiddleware
import uvicorn
import os
import json
import shutil
from datetime import datetime
from typing import Optional

app = FastAPI(title="Telegram Mini App", version="12.0.0")

# Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµĞ¼ CORS
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"],
)

# ĞŸÑƒÑ‚Ğ¸
current_dir = os.path.dirname(os.path.abspath(__file__))
frontend_dir = os.path.join(current_dir, "../frontend")
DATA_FILE = os.path.join(current_dir, "data.json")
UPLOAD_DIR = os.path.join(current_dir, "uploads")

# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¾Ğº ĞµÑĞ»Ğ¸ ĞµÑ‘ Ğ½ĞµÑ‚
os.makedirs(UPLOAD_DIR, exist_ok=True)

print("ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ÑĞµÑ€Ğ²ĞµÑ€ Ñ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ñ„Ğ¸Ñ‡Ğ°Ğ¼Ğ¸...")

# Ğ Ğ°Ğ·Ğ´Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
if os.path.exists(frontend_dir):
    app.mount("/static", StaticFiles(directory=frontend_dir), name="static")

# Ğ Ğ°Ğ·Ğ´Ğ°ĞµĞ¼ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
app.mount("/uploads", StaticFiles(directory=UPLOAD_DIR), name="uploads")

# Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
def load_data():
    if not os.path.exists(DATA_FILE):
        return {
            "profiles": [],
            "chats": [],
            "messages": [],
            "comments": [],
            "promocodes": [],
            "settings": {
                "crypto_wallets": {
                    "trc20": "TY76gU8J9o8j7U6tY5r4E3W2Q1",
                    "erc20": "0x8a9C6e5D8b0E2a1F3c4B6E7D8C9A0B1C2D3E4F5",
                    "bnb": "bnb1q3e5r7t9y1u3i5o7p9l1k3j5h7g9f2d4s6q8w0"
                },
                "banner": {
                    "text": "Special Offer: 15% discount with promo code WELCOME15",
                    "visible": True,
                    "link": "https://t.me/yourchannel",
                    "link_text": "Join Channel"
                }
            }
        }
    try:
        with open(DATA_FILE, 'r', encoding='utf-8') as f:
            data = json.loads(f.read())
            # Ensure settings exist
            if "settings" not in data:
                data["settings"] = {
                    "crypto_wallets": {
                        "trc20": "TY76gU8J9o8j7U6tY5r4E3W2Q1",
                        "erc20": "0x8a9C6e5D8b0E2a1F3c4B6E7D8C9A0B1C2D3E4F5",
                        "bnb": "bnb1q3e5r7t9y1u3i5o7p9l1k3j5h7g9f2d4s6q8w0"
                    },
                    "banner": {
                        "text": "Special Offer: 15% discount with promo code WELCOME15",
                        "visible": True,
                        "link": "https://t.me/yourchannel",
                        "link_text": "Join Channel"
                    }
                }
            if "promocodes" not in data:
                data["promocodes"] = []
            if "comments" not in data:
                data["comments"] = []
            return data
    except:
        return {
            "profiles": [],
            "chats": [],
            "messages": [],
            "comments": [],
            "promocodes": [],
            "settings": {
                "crypto_wallets": {
                    "trc20": "TY76gU8J9o8j7U6tY5r4E3W2Q1",
                    "erc20": "0x8a9C6e5D8b0E2a1F3c4B6E7D8C9A0B1C2D3E4F5",
                    "bnb": "bnb1q3e5r7t9y1u3i5o7p9l1k3j5h7g9f2d4s6q8w0"
                },
                "banner": {
                    "text": "Special Offer: 15% discount with promo code WELCOME15",
                    "visible": True,
                    "link": "https://t.me/yourchannel",
                    "link_text": "Join Channel"
                }
            }
        }

# Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
def save_data(data):
    try:
        with open(DATA_FILE, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        return True
    except:
        return False

# Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
def save_uploaded_file(file: UploadFile) -> str:
    """Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ½ĞµĞ¼Ñƒ"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S_%f")
    filename = f"{timestamp}_{file.filename}"
    file_path = os.path.join(UPLOAD_DIR, filename)

    with open(file_path, "wb") as buffer:
        shutil.copyfileobj(file.file, buffer)

    return f"/uploads/{filename}"

# ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ Ñ‚Ğ¸Ğ¿ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¿Ğ¾ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ
def get_file_type(filename: str) -> str:
    extension = filename.lower().split('.')[-1]
    image_extensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp']
    video_extensions = ['mp4', 'avi', 'mov', 'mkv', 'webm']

    if extension in image_extensions:
        return 'image'
    elif extension in video_extensions:
        return 'video'
    else:
        return 'file'

# API endpoints
@app.get("/")
async def main():
    return FileResponse(os.path.join(frontend_dir, "index.html"))

@app.get("/api/profiles")
async def get_profiles(
    page: int = 0,
    limit: int = 12,
    city: str = None,
    nationality: str = None,
    travel_city: str = None,
    age_min: int = None,
    age_max: int = None,
    height_min: int = None,
    height_max: int = None,
    weight_min: int = None,
    weight_max: int = None,
    chest_min: int = None,
    chest_max: int = None
):
    data = load_data()
    profiles = [p for p in data["profiles"] if p.get("visible", True)]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ñƒ
    if city and city != "all":
        profiles = [p for p in profiles if p.get("city", "").lower() == city.lower()]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    if nationality and nationality != "all":
        profiles = [p for p in profiles if p.get("nationality", "").lower() == nationality.lower()]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ñƒ Ğ²Ñ‹Ğ»ĞµÑ‚Ğ°
    if travel_city and travel_city != "all":
        profiles = [p for p in profiles if travel_city.lower() in [c.lower() for c in p.get("travel_cities", [])]]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ñƒ
    if age_min:
        profiles = [p for p in profiles if p.get("age", 0) >= age_min]
    if age_max:
        profiles = [p for p in profiles if p.get("age", 100) <= age_max]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ñ€Ğ¾ÑÑ‚Ñƒ
    if height_min:
        profiles = [p for p in profiles if p.get("height", 0) >= height_min]
    if height_max:
        profiles = [p for p in profiles if p.get("height", 250) <= height_max]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ²ĞµÑÑƒ
    if weight_min:
        profiles = [p for p in profiles if p.get("weight", 0) >= weight_min]
    if weight_max:
        profiles = [p for p in profiles if p.get("weight", 200) <= weight_max]

    # Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ³Ñ€ÑƒĞ´Ğ¸
    if chest_min:
        profiles = [p for p in profiles if p.get("chest", 0) >= chest_min]
    if chest_max:
        profiles = [p for p in profiles if p.get("chest", 12) <= chest_max]

    # ĞŸĞ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ
    start = page * limit
    end = start + limit
    paginated_profiles = profiles[start:end]

    return {
        "profiles": paginated_profiles,
        "has_more": end < len(profiles),
        "total": len(profiles)
    }

@app.get("/api/filters/cities")
async def get_cities():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ² Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°"""
    data = load_data()
    cities = list(set([p.get("city", "") for p in data["profiles"] if p.get("city")]))
    return {"cities": sorted(cities)}

@app.get("/api/filters/nationalities")
async def get_nationalities():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°"""
    data = load_data()
    nationalities = list(set([p.get("nationality", "") for p in data["profiles"] if p.get("nationality")]))
    return {"nationalities": sorted(nationalities)}

@app.get("/api/filters/travel_cities")
async def get_travel_cities():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ² Ğ²Ñ‹Ğ»ĞµÑ‚Ğ°"""
    data = load_data()
    travel_cities = set()
    for profile in data["profiles"]:
        if "travel_cities" in profile:
            travel_cities.update(profile["travel_cities"])
    return {"travel_cities": sorted(list(travel_cities))}

@app.get("/api/profiles/{profile_id}")
async def get_profile(profile_id: int):
    data = load_data()
    profile = next((p for p in data["profiles"] if p["id"] == profile_id), None)
    if not profile:
        raise HTTPException(status_code=404, detail="Profile not found")

    # Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ
    comments = [c for c in data.get("comments", []) if c["profile_id"] == profile_id]
    profile["comments"] = comments

    return profile

@app.post("/api/chats/{profile_id}/messages")
async def send_message(
    profile_id: int,
    text: str = Form(None),
    file: UploadFile = File(None)
):
    """ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¿Ñ€Ğ¸ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ°"""
    data = load_data()

    # ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ´Ğ»Ñ Ğ¸Ğ¼ĞµĞ½Ğ¸
    profile = next((p for p in data["profiles"] if p["id"] == profile_id), None)
    if not profile:
        raise HTTPException(status_code=404, detail="Profile not found")

    # ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ¸Ğ»Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ‡Ğ°Ñ‚
    chat = next((c for c in data["chats"] if c["profile_id"] == profile_id), None)
    if not chat:
        chat = {
            "id": len(data["chats"]) + 1,
            "profile_id": profile_id,
            "profile_name": profile["name"],
            "created_at": datetime.now().isoformat()
        }
        data["chats"].append(chat)

    # ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
    message_data = {
        "id": len(data["messages"]) + 1,
        "chat_id": chat["id"],
        "is_from_user": True,
        "created_at": datetime.now().isoformat()
    }

    # Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ñ„Ğ°Ğ¹Ğ»
    if file and file.filename:
        file_url = save_uploaded_file(file)
        file_type = get_file_type(file.filename)

        message_data.update({
            "file_url": file_url,
            "file_type": file_type,
            "file_name": file.filename,
            "text": text or ""  # Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ‚ĞµĞºÑÑ‚ Ñ Ğ¸Ğ¼ĞµĞ½ĞµĞ¼ Ñ„Ğ°Ğ¹Ğ»Ğ°
        })
    else:
        # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚ĞµĞºÑÑ‚
        if not text:
            raise HTTPException(status_code=400, detail="Text or file is required")
        message_data["text"] = text

    data["messages"].append(message_data)
    save_data(data)
    return {"status": "sent", "message_id": message_data["id"]}

@app.get("/api/chats/{profile_id}/messages")
async def get_chat_messages(profile_id: int):
    data = load_data()
    chat = next((c for c in data["chats"] if c["profile_id"] == profile_id), None)
    if not chat:
        return {"messages": []}

    messages = [m for m in data["messages"] if m["chat_id"] == chat["id"]]
    return {"messages": messages}

@app.get("/api/chats/{profile_id}/updates")
async def get_chat_updates(profile_id: int, last_message_id: int = 0):
    data = load_data()
    chat = next((c for c in data["chats"] if c["profile_id"] == profile_id), None)
    if not chat:
        return {"messages": [], "last_message_id": 0}

    messages = [m for m in data["messages"] if m["chat_id"] == chat["id"] and m["id"] > last_message_id]
    max_id = max([m["id"] for m in data["messages"]]) if data["messages"] else 0

    return {"messages": messages, "last_message_id": max_id}

# ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğº Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑĞ¼
@app.get("/api/profiles/{profile_id}/comments")
async def get_profile_comments(profile_id: int):
    data = load_data()
    comments = [c for c in data.get("comments", []) if c["profile_id"] == profile_id]
    return {"comments": comments}

@app.post("/api/profiles/{profile_id}/comments")
async def add_profile_comment(profile_id: int, comment_data: dict):
    data = load_data()

    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ
    profile = next((p for p in data["profiles"] if p["id"] == profile_id), None)
    if not profile:
        raise HTTPException(status_code=404, detail="Profile not found")

    new_comment = {
        "id": len(data.get("comments", [])) + 1,
        "profile_id": profile_id,
        "user_name": "Anonymous User",  # Ğ’ÑĞµĞ³Ğ´Ğ° Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¹
        "text": comment_data["text"],
        "created_at": datetime.now().isoformat()
    }

    if "comments" not in data:
        data["comments"] = []
    data["comments"].append(new_comment)
    save_data(data)

    return {"status": "added", "comment": new_comment}

@app.delete("/api/profiles/{profile_id}/comments/{comment_id}")
async def delete_profile_comment(profile_id: int, comment_id: int):
    """Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ñ (Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸)"""
    data = load_data()

    if "comments" not in data:
        raise HTTPException(status_code=404, detail="No comments found")

    # ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹
    comment_index = next((i for i, c in enumerate(data["comments"]) if c["id"] == comment_id and c["profile_id"] == profile_id), None)

    if comment_index is None:
        raise HTTPException(status_code=404, detail="Comment not found")

    # Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹
    deleted_comment = data["comments"].pop(comment_index)
    save_data(data)

    return {"status": "deleted", "comment": deleted_comment}

@app.get("/api/settings/crypto_wallets")
async def get_crypto_wallets():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾-ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ¾Ğ²"""
    data = load_data()
    return data.get("settings", {}).get("crypto_wallets", {})

@app.post("/api/settings/crypto_wallets")
async def update_crypto_wallets(wallets: dict):
    """ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾-ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ¾Ğ²"""
    data = load_data()
    if "settings" not in data:
        data["settings"] = {}
    data["settings"]["crypto_wallets"] = wallets
    save_data(data)
    return {"status": "updated"}

@app.get("/api/settings/banner")
async def get_banner():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ°"""
    data = load_data()
    return data.get("settings", {}).get("banner", {})

@app.post("/api/settings/banner")
async def update_banner(banner: dict):
    """ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ°"""
    data = load_data()
    if "settings" not in data:
        data["settings"] = {}
    data["settings"]["banner"] = banner
    save_data(data)
    return {"status": "updated"}

# ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ñ‹
@app.get("/api/promocodes")
async def get_promocodes():
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ñ‹"""
    data = load_data()
    return {"promocodes": data.get("promocodes", [])}

@app.post("/api/promocodes")
async def create_promocode(promocode: dict):
    """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´"""
    data = load_data()

    new_promocode = {
        "id": len(data["promocodes"]) + 1,
        "code": promocode["code"].upper(),
        "discount": promocode["discount"],
        "is_active": True,
        "used_by": [],
        "created_at": datetime.now().isoformat()
    }

    data["promocodes"].append(new_promocode)
    save_data(data)
    return {"status": "created", "promocode": new_promocode}

@app.post("/api/promocodes/{promocode_id}/toggle")
async def toggle_promocode(promocode_id: int):
    """ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ/Ğ´ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´"""
    data = load_data()
    promocode = next((p for p in data["promocodes"] if p["id"] == promocode_id), None)
    if promocode:
        promocode["is_active"] = not promocode["is_active"]
        save_data(data)
    return {"status": "updated"}

@app.delete("/api/promocodes/{promocode_id}")
async def delete_promocode(promocode_id: int):
    """Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´"""
    data = load_data()
    data["promocodes"] = [p for p in data["promocodes"] if p["id"] != promocode_id]
    save_data(data)
    return {"status": "deleted"}

@app.post("/api/promocodes/validate")
async def validate_promocode(validation: dict):
    """ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´"""
    data = load_data()
    code = validation["code"].upper()

    promocode = next((p for p in data["promocodes"] if p["code"] == code), None)

    if not promocode:
        return {"valid": False, "message": "Promocode not found"}

    if not promocode["is_active"]:
        return {"valid": False, "message": "Promocode is inactive"}

    return {
        "valid": True,
        "discount": promocode["discount"],
        "message": f"Promocode activated! {promocode['discount']}% discount applied"
    }

# Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
@app.post("/api/payment/crypto")
async def process_crypto_payment(payment_data: dict):
    """ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾-Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°"""
    data = load_data()

    # Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶
    payment_log = {
        "id": len(data.get("payments", [])) + 1,
        "profile_id": payment_data["profile_id"],
        "amount": payment_data["amount"],
        "currency": payment_data["currency"],
        "wallet": payment_data["wallet"],
        "status": "pending",  # Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¾ Ğ½Ğ° pending Ğ´Ğ»Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ
        "created_at": datetime.now().isoformat()
    }

    if "payments" not in data:
        data["payments"] = []
    data["payments"].append(payment_log)
    save_data(data)

    return {
        "status": "pending",
        "message": "Payment is being processed",
        "payment_id": payment_log["id"]
    }

@app.get("/api/translations/{lang}")
async def get_translations(lang: str):
    """ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ°"""
    translations = {
        "en": {
            "app_name": "Ashoo",
            "subtitle": "100% Anonymous Dating",
            "premium_profiles": "Premium Profiles",
            "online_now": "Online Now",
            "anonymous_dating": "Anonymous Dating",
            "filters": "Filters",
            "city": "City",
            "nationality": "Nationality",
            "travel_city": "Travel City",
            "all_cities": "All cities",
            "all_nationalities": "All nationalities",
            "age": "Age",
            "height": "Height (cm)",
            "weight": "Weight (kg)",
            "chest": "Chest",
            "chest_sizes": {
                "1": "1 chest",
                "2": "2 chest",
                "3": "3 chest",
                "4": "4 chest",
                "5": "5 chest",
                "6": "6 chest",
                "7": "7 chest",
                "8": "8 chest",
                "9": "9 chest",
                "10": "10 chest",
                "11": "11 chest",
                "12": "12 chest"
            },
            "reset": "Reset",
            "apply": "Apply",
            "loading": "Loading profiles...",
            "loading_more": "Loading more profiles...",
            "view_profile": "View Profile",
            "write_message": "Write Message",
            "book_with_crypto": "Book with Crypto",
            "more": "More",
            "share": "Share",
            "chat_with": "Chat with",
            "type_message": "Type a message...",
            "send": "â¤",
            "no_chats": "No active chats",
            "no_profiles": "No profiles found",
            "new": "NEW",
            "years": "years",
            "cm": "cm",
            "kg": "kg",
            "download": "Download",
            "pay_with_crypto": "Pay with Crypto",
            "crypto_payment": "Crypto Payment",
            "select_network": "Select Network",
            "wallet_address": "Wallet Address",
            "copy": "Copy",
            "copied": "Copied!",
            "close": "Close",
            "payment_awaiting": "Awaiting Confirmation",
            "payment_processing": "Your payment is being processed. Please wait for confirmation message.",
            "travel_cities": "Travel Cities",
            "description": "Description",
            "welcome_message": "Hello! Write me a message",
            "error_sending": "Error sending message",
            "promocode": "Promo Code",
            "enter_promocode": "Enter promo code",
            "apply_promocode": "Apply",
            "promocode_applied": "Promo code applied!",
            "promocode_invalid": "Invalid promo code",
            "discount": "Discount",
            "banner_join": "Join Channel",
            "attach_file": "Attach File",
            "file": "File",
            "photo": "Photo",
            "video": "Video",
            "add_comment": "Add Comment",
            "comments": "Comments",
            "no_comments": "No comments yet",
            "your_comment": "Your comment",
            "post_comment": "Post Comment",
            "rating": "Rating",
            "payment_processing": "Processing payment...",
            "select_crypto": "Select Cryptocurrency",
            "amount": "Amount",
            "usd": "USD",
            "pay_now": "Pay Now",
            "booking_profile": "Booking Profile"
        },
        "ja": {
            "app_name": "Ashoo",
            "subtitle": "100% åŒ¿åãƒ‡ãƒ¼ãƒˆ",
            "premium_profiles": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«",
            "online_now": "ã‚ªãƒ³ãƒ©ã‚¤ãƒ³",
            "anonymous_dating": "åŒ¿åãƒ‡ãƒ¼ãƒˆ",
            "filters": "ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼",
            "city": "éƒ½å¸‚",
            "nationality": "å›½ç±",
            "travel_city": "æ—…è¡Œå…ˆéƒ½å¸‚",
            "all_cities": "ã™ã¹ã¦ã®éƒ½å¸‚",
            "all_nationalities": "ã™ã¹ã¦ã®å›½ç±",
            "age": "å¹´é½¢",
            "height": "èº«é•· (cm)",
            "weight": "ä½“é‡ (kg)",
            "chest": "ãƒã‚¹ãƒˆ",
            "chest_sizes": {
                "1": "1 ãƒã‚¹ãƒˆ",
                "2": "2 ãƒã‚¹ãƒˆ",
                "3": "3 ãƒã‚¹ãƒˆ",
                "4": "4 ãƒã‚¹ãƒˆ",
                "5": "5 ãƒã‚¹ãƒˆ",
                "6": "6 ãƒã‚¹ãƒˆ",
                "7": "7 ãƒã‚¹ãƒˆ",
                "8": "8 ãƒã‚¹ãƒˆ",
                "9": "9 ãƒã‚¹ãƒˆ",
                "10": "10 ãƒã‚¹ãƒˆ",
                "11": "11 ãƒã‚¹ãƒˆ",
                "12": "12 ãƒã‚¹ãƒˆ"
            },
            "reset": "ãƒªã‚»ãƒƒãƒˆ",
            "apply": "é©ç”¨",
            "loading": "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿ä¸­...",
            "loading_more": "ã•ã‚‰ã«èª­ã¿è¾¼ã¿ä¸­...",
            "view_profile": "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’è¦‹ã‚‹",
            "write_message": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹",
            "book_with_crypto": "æš—å·é€šè²¨ã§äºˆç´„",
            "more": "ã‚‚ã£ã¨è¦‹ã‚‹",
            "share": "å…±æœ‰",
            "chat_with": "ã¨ã®ãƒãƒ£ãƒƒãƒˆ",
            "type_message": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...",
            "send": "â¤",
            "no_chats": "ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒãƒ£ãƒƒãƒˆã¯ã‚ã‚Šã¾ã›ã‚“",
            "no_profiles": "ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
            "new": "æ–°ç€",
            "years": "æ­³",
            "cm": "cm",
            "kg": "kg",
            "download": "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
            "pay_with_crypto": "æš—å·é€šè²¨ã§æ”¯æ‰•ã†",
            "crypto_payment": "æš—å·é€šè²¨æ±ºæ¸ˆ",
            "select_network": "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é¸æŠ",
            "wallet_address": "ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹",
            "copy": "ã‚³ãƒ”ãƒ¼",
            "copied": "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼",
            "close": "é–‰ã˜ã‚‹",
            "payment_awaiting": "ç¢ºèªå¾…ã¡",
            "payment_processing": "ãŠæ”¯æ‰•ã„ã‚’å‡¦ç†ä¸­ã§ã™ã€‚ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãŠå¾…ã¡ãã ã•ã„ã€‚",
            "travel_cities": "æ—…è¡Œå…ˆéƒ½å¸‚",
            "description": "èª¬æ˜",
            "welcome_message": "ã“ã‚“ã«ã¡ã¯ï¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™",
            "error_sending": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ã‚¨ãƒ©ãƒ¼",
            "promocode": "ãƒ—ãƒ­ãƒ¢ã‚³ãƒ¼ãƒ‰",
            "enter_promocode": "ãƒ—ãƒ­ãƒ¢ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›",
            "apply_promocode": "é©ç”¨",
            "promocode_applied": "ãƒ—ãƒ­ãƒ¢ã‚³ãƒ¼ãƒ‰ãŒé©ç”¨ã•ã‚Œã¾ã—ãŸï¼",
            "promocode_invalid": "ç„¡åŠ¹ãªãƒ—ãƒ­ãƒ¢ã‚³ãƒ¼ãƒ‰",
            "discount": "å‰²å¼•",
            "banner_join": "ãƒãƒ£ãƒ³ãƒãƒ«ã«å‚åŠ ",
            "attach_file": "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜",
            "file": "ãƒ•ã‚¡ã‚¤ãƒ«",
            "photo": "å†™çœŸ",
            "video": "ãƒ“ãƒ‡ã‚ª",
            "add_comment": "ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ",
            "comments": "ã‚³ãƒ¡ãƒ³ãƒˆ",
            "no_comments": "ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“",
            "your_comment": "ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›",
            "post_comment": "ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿",
            "rating": "è©•ä¾¡",
            "payment_processing": "æ”¯æ‰•ã„ã‚’å‡¦ç†ä¸­...",
            "select_crypto": "æš—å·é€šè²¨ã‚’é¸æŠ",
            "amount": "é‡‘é¡",
            "usd": "USD",
            "pay_now": "ä»Šã™ãæ”¯æ‰•ã†",
            "booking_profile": "äºˆç´„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«"
        },
        "ko": {
            "app_name": "Ashoo",
            "subtitle": "100% ìµëª… ë°ì´íŠ¸",
            "premium_profiles": "í”„ë¦¬ë¯¸ì—„ í”„ë¡œí•„",
            "online_now": "ì˜¨ë¼ì¸",
            "anonymous_dating": "ìµëª… ë°ì´íŠ¸",
            "filters": "í•„í„°",
            "city": "ë„ì‹œ",
            "nationality": "êµ­ì ",
            "travel_city": "ì—¬í–‰ ë„ì‹œ",
            "all_cities": "ëª¨ë“  ë„ì‹œ",
            "all_nationalities": "ëª¨ë“  êµ­ì ",
            "age": "ë‚˜ì´",
            "height": "í‚¤ (cm)",
            "weight": "ì²´ì¤‘ (kg)",
            "chest": "ê°€ìŠ´",
            "chest_sizes": {
                "1": "1 ê°€ìŠ´",
                "2": "2 ê°€ìŠ´",
                "3": "3 ê°€ìŠ´",
                "4": "4 ê°€ìŠ´",
                "5": "5 ê°€ìŠ´",
                "6": "6 ê°€ìŠ´",
                "7": "7 ê°€ìŠ´",
                "8": "8 ê°€ìŠ´",
                "9": "9 ê°€ìŠ´",
                "10": "10 ê°€ìŠ´",
                "11": "11 ê°€ìŠ´",
                "12": "12 ê°€ìŠ´"
            },
            "reset": "ì´ˆê¸°í™”",
            "apply": "ì ìš©",
            "loading": "í”„ë¡œí•„ ë¡œë”© ì¤‘...",
            "loading_more": "ë” ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",
            "view_profile": "í”„ë¡œí•„ ë³´ê¸°",
            "write_message": "ë©”ì‹œì§€ ë³´ë‚´ê¸°",
            "book_with_crypto": "ì•”í˜¸í™”íë¡œ ì˜ˆì•½",
            "more": "ë”ë³´ê¸°",
            "share": "ê³µìœ ",
            "chat_with": "ì™€ì˜ ì±„íŒ…",
            "type_message": "ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...",
            "send": "â¤",
            "no_chats": "í™œì„±í™”ëœ ì±„íŒ…ì´ ì—†ìŠµë‹ˆë‹¤",
            "no_profiles": "í”„ë¡œí•„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
            "new": "ìƒˆë¡œìš´",
            "years": "ì„¸",
            "cm": "cm",
            "kg": "kg",
            "download": "ë‹¤ìš´ë¡œë“œ",
            "pay_with_crypto": "ì•”í˜¸í™”íë¡œ ê²°ì œ",
            "crypto_payment": "ì•”í˜¸í™”í ê²°ì œ",
            "select_network": "ë„¤íŠ¸ì›Œí¬ ì„ íƒ",
            "wallet_address": "ì§€ê°‘ ì£¼ì†Œ",
            "copy": "ë³µì‚¬",
            "copied": "ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!",
            "close": "ë‹«ê¸°",
            "payment_awaiting": "í™•ì¸ ëŒ€ê¸° ì¤‘",
            "payment_processing": "ê²°ì œê°€ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤. í™•ì¸ ë©”ì‹œì§€ë¥¼ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.",
            "travel_cities": "ì—¬í–‰ ë„ì‹œ",
            "description": "ì„¤ëª…",
            "welcome_message": "ì•ˆë…•í•˜ì„¸ìš”! ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì£¼ì„¸ìš”",
            "error_sending": "ë©”ì‹œì§€ ì „ì†¡ ì˜¤ë¥˜",
            "promocode": "í”„ë¡œëª¨ ì½”ë“œ",
            "enter_promocode": "í”„ë¡œëª¨ ì½”ë“œ ì…ë ¥",
            "apply_promocode": "ì ìš©",
            "promocode_applied": "í”„ë¡œëª¨ ì½”ë“œê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!",
            "promocode_invalid": "ìœ íš¨í•˜ì§€ ì•Šì€ í”„ë¡œëª¨ ì½”ë“œ",
            "discount": "í• ì¸",
            "banner_join": "ì±„ë„ ì°¸ì—¬",
            "attach_file": "íŒŒì¼ ì²¨ë¶€",
            "file": "íŒŒì¼",
            "photo": "ì‚¬ì§„",
            "video": "ë™ì˜ìƒ",
            "add_comment": "ëŒ“ê¸€ ì¶”ê°€",
            "comments": "ëŒ“ê¸€",
            "no_comments": "ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤",
            "your_comment": "ëŒ“ê¸€ ì…ë ¥",
            "post_comment": "ëŒ“ê¸€ ì‘ì„±",
            "rating": "í‰ì ",
            "payment_processing": "ê²°ì œ ì²˜ë¦¬ ì¤‘...",
            "select_crypto": "ì•”í˜¸í™”í ì„ íƒ",
            "amount": "ê¸ˆì•¡",
            "usd": "USD",
            "pay_now": "ì§€ê¸ˆ ê²°ì œ",
            "booking_profile": "ì˜ˆì•½ í”„ë¡œí•„"
        },
        "ar": {
            "app_name": "Ashoo",
            "subtitle": "100% Ù…ÙˆØ§Ø¹Ø¯Ø© Ù…Ø¬Ù‡ÙˆÙ„Ø©",
            "premium_profiles": "Ù…Ù„ÙØ§Øª Ù…Ù…ÙŠØ²Ø©",
            "online_now": "Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†",
            "anonymous_dating": "Ù…ÙˆØ§Ø¹Ø¯Ø© Ù…Ø¬Ù‡ÙˆÙ„Ø©",
            "filters": "Ø§Ù„ÙÙ„Ø§ØªØ±",
            "city": "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©",
            "nationality": "Ø§Ù„Ø¬Ù†Ø³ÙŠØ©",
            "travel_city": "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø³ÙØ±",
            "all_cities": "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯Ù†",
            "all_nationalities": "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª",
            "age": "Ø§Ù„Ø¹Ù…Ø±",
            "height": "Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)",
            "weight": "Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…)",
            "chest": "Ø§Ù„ØµØ¯Ø±",
            "chest_sizes": {
                "1": "1 ØµØ¯Ø±",
                "2": "2 ØµØ¯Ø±",
                "3": "3 ØµØ¯Ø±",
                "4": "4 ØµØ¯Ø±",
                "5": "5 ØµØ¯Ø±",
                "6": "6 ØµØ¯Ø±",
                "7": "7 ØµØ¯Ø±",
                "8": "8 ØµØ¯Ø±",
                "9": "9 ØµØ¯Ø±",
                "10": "10 ØµØ¯Ø±",
                "11": "11 ØµØ¯Ø±",
                "12": "12 ØµØ¯Ø±"
            },
            "reset": "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",
            "apply": "ØªØ·Ø¨ÙŠÙ‚",
            "loading": "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©...",
            "loading_more": "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯...",
            "view_profile": "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",
            "write_message": "ÙƒØªØ§Ø¨Ø© Ø±Ø³Ø§Ù„Ø©",
            "book_with_crypto": "Ø§Ù„Ø­Ø¬Ø² Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©",
            "more": "Ø§Ù„Ù…Ø²ÙŠØ¯",
            "share": "Ù…Ø´Ø§Ø±ÙƒØ©",
            "chat_with": "Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¹",
            "type_message": "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...",
            "send": "â¤",
            "no_chats": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù†Ø´Ø·Ø©",
            "no_profiles": "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª Ø´Ø®ØµÙŠØ©",
            "new": "Ø¬Ø¯ÙŠØ¯",
            "years": "Ø³Ù†Ø©",
            "cm": "Ø³Ù…",
            "kg": "ÙƒØ¬Ù…",
            "download": "ØªØ­Ù…ÙŠÙ„",
            "pay_with_crypto": "Ø§Ù„Ø¯ÙØ¹ Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©",
            "crypto_payment": "Ø§Ù„Ø¯ÙØ¹ Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©",
            "select_network": "Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¨ÙƒØ©",
            "wallet_address": "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©",
            "copy": "Ù†Ø³Ø®",
            "copied": "ØªÙ… Ø§Ù„Ù†Ø³Ø®!",
            "close": "Ø¥ØºÙ„Ø§Ù‚",
            "payment_awaiting": "ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯",
            "payment_processing": "Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¯ÙØ¹ØªÙƒ. ÙŠØ±Ø¬Ù‰ Ø§Ù†ØªØ¸Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯.",
            "travel_cities": "Ù…Ø¯Ù† Ø§Ù„Ø³ÙØ±",
            "description": "Ø§Ù„ÙˆØµÙ",
            "welcome_message": "Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§ÙƒØªØ¨ Ù„ÙŠ Ø±Ø³Ø§Ù„Ø©",
            "error_sending": "Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©",
            "promocode": "ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…",
            "enter_promocode": "Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…",
            "apply_promocode": "ØªØ·Ø¨ÙŠÙ‚",
            "promocode_applied": "ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…!",
            "promocode_invalid": "ÙƒÙˆØ¯ Ø®ØµÙ… ØºÙŠØ± ØµØ§Ù„Ø­",
            "discount": "Ø®ØµÙ…",
            "banner_join": "Ø§Ù†Ø¶Ù… Ù„Ù„Ù‚Ù†Ø§Ø©",
            "attach_file": "Ø¥Ø±ÙØ§Ù‚ Ù…Ù„Ù",
            "file": "Ù…Ù„Ù",
            "photo": "ØµÙˆØ±Ø©",
            "video": "ÙÙŠØ¯ÙŠÙˆ",
            "add_comment": "Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚",
            "comments": "Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª",
            "no_comments": "Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯",
            "your_comment": "ØªØ¹Ù„ÙŠÙ‚Ùƒ",
            "post_comment": "Ù†Ø´Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ‚",
            "rating": "Ø§Ù„ØªÙ‚ÙŠÙŠÙ…",
            "payment_processing": "Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¯ÙØ¹...",
            "select_crypto": "Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø´ÙØ±Ø©",
            "amount": "Ø§Ù„Ù…Ø¨Ù„Øº",
            "usd": "USD",
            "pay_now": "Ø§Ø¯ÙØ¹ Ø§Ù„Ø¢Ù†",
            "booking_profile": "Ù…Ù„Ù Ø§Ù„Ø­Ø¬Ø²"
        },
        "zh": {
            "app_name": "Ashoo",
            "subtitle": "100% åŒ¿åçº¦ä¼š",
            "premium_profiles": "é«˜çº§èµ„æ–™",
            "online_now": "åœ¨çº¿",
            "anonymous_dating": "åŒ¿åçº¦ä¼š",
            "filters": "ç­›é€‰",
            "city": "åŸå¸‚",
            "nationality": "å›½ç±",
            "travel_city": "å‡ºå‘åŸå¸‚",
            "all_cities": "æ‰€æœ‰åŸå¸‚",
            "all_nationalities": "æ‰€æœ‰å›½ç±",
            "age": "å¹´é¾„",
            "height": "èº«é«˜ (å˜ç±³)",
            "weight": "ä½“é‡ (å…¬æ–¤)",
            "chest": "èƒ¸å›´",
            "chest_sizes": {
                "1": "1èƒ¸å›´",
                "2": "2èƒ¸å›´",
                "3": "3èƒ¸å›´",
                "4": "4èƒ¸å›´",
                "5": "5èƒ¸å›´",
                "6": "6èƒ¸å›´",
                "7": "7èƒ¸å›´",
                "8": "8èƒ¸å›´",
                "9": "9èƒ¸å›´",
                "10": "10èƒ¸å›´",
                "11": "11èƒ¸å›´",
                "12": "12èƒ¸å›´"
            },
            "reset": "é‡ç½®",
            "apply": "åº”ç”¨",
            "loading": "åŠ è½½ä¸ªäººèµ„æ–™...",
            "loading_more": "åŠ è½½æ›´å¤šä¸ªäººèµ„æ–™...",
            "view_profile": "æŸ¥çœ‹èµ„æ–™",
            "write_message": "å‘é€æ¶ˆæ¯",
            "book_with_crypto": "åŠ å¯†è´§å¸é¢„è®¢",
            "more": "æ›´å¤š",
            "share": "åˆ†äº«",
            "chat_with": "ä¸èŠå¤©",
            "type_message": "è¾“å…¥æ¶ˆæ¯...",
            "send": "â¤",
            "no_chats": "æ²¡æœ‰æ´»è·ƒèŠå¤©",
            "no_profiles": "æœªæ‰¾åˆ°ä¸ªäººèµ„æ–™",
            "new": "æ–°",
            "years": "å²",
            "cm": "å˜ç±³",
            "kg": "å…¬æ–¤",
            "download": "ä¸‹è½½",
            "pay_with_crypto": "åŠ å¯†è´§å¸æ”¯ä»˜",
            "crypto_payment": "åŠ å¯†è´§å¸æ”¯ä»˜",
            "select_network": "é€‰æ‹©ç½‘ç»œ",
            "wallet_address": "é’±åŒ…åœ°å€",
            "copy": "å¤åˆ¶",
            "copied": "å·²å¤åˆ¶ï¼",
            "close": "å…³é—­",
            "payment_awaiting": "ç­‰å¾…ç¡®è®¤",
            "payment_processing": "æ‚¨çš„ä»˜æ¬¾æ­£åœ¨å¤„ç†ä¸­ã€‚è¯·ç­‰å¾…ç¡®è®¤æ¶ˆæ¯ã€‚",
            "travel_cities": "å‡ºå‘åŸå¸‚",
            "description": "æè¿°",
            "welcome_message": "ä½ å¥½ï¼ç»™æˆ‘å‘æ¶ˆæ¯å§",
            "error_sending": "å‘é€æ¶ˆæ¯é”™è¯¯",
            "promocode": "ä¼˜æƒ ç ",
            "enter_promocode": "è¾“å…¥ä¼˜æƒ ç ",
            "apply_promocode": "åº”ç”¨",
            "promocode_applied": "ä¼˜æƒ ç å·²åº”ç”¨ï¼",
            "promocode_invalid": "æ— æ•ˆä¼˜æƒ ç ",
            "discount": "æŠ˜æ‰£",
            "banner_join": "åŠ å…¥é¢‘é“",
            "attach_file": "é™„åŠ æ–‡ä»¶",
            "file": "æ–‡ä»¶",
            "photo": "ç…§ç‰‡",
            "video": "è§†é¢‘",
            "add_comment": "æ·»åŠ è¯„è®º",
            "comments": "è¯„è®º",
            "no_comments": "æš‚æ— è¯„è®º",
            "your_comment": "æ‚¨çš„è¯„è®º",
            "post_comment": "å‘è¡¨è¯„è®º",
            "rating": "è¯„åˆ†",
            "payment_processing": "å¤„ç†æ”¯ä»˜ä¸­...",
            "select_crypto": "é€‰æ‹©åŠ å¯†è´§å¸",
            "amount": "é‡‘é¢",
            "usd": "USD",
            "pay_now": "ç«‹å³æ”¯ä»˜",
            "booking_profile": "é¢„è®¢èµ„æ–™"
        }
    }

    return translations.get(lang, translations["en"])

@app.get("/api/test")
async def test():
    return {"status": "ok", "message": "Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚!"}

if __name__ == "__main__":
    print("ğŸš€ Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½: http://localhost:8001")
    print("ğŸ¨ Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ¸Ñ‡Ğ¸: Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸, ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ Ñ‡Ğ°Ñ‚, Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´!")
    uvicorn.run(app, host="0.0.0.0", port=8001, access_log=False)